define(["jquery","cors","layer","utils","handlebars","nicescroll"],function(d,t,a,e,g,i){a.config({path:window.gConfig.staticPath+"static/libs/layer/"}),{init:function(){var l=this;e.EMSSO(),l.flag=!0,l.clickLoaded=!1,l.loadALLStategy=!1,l.getFixedStrategyListData={},l.stategyInfoIObj={},l.stategyArticleObj={},l.relationVideoObj={},l.otherLatestVideo={},l.isGroup=e.GetQueryString("isGroup"),l.ClientStrategyID=e.GetQueryString("ClientStrategyID"),l.articleID=e.GetQueryString("articleId")||e.GetQueryString("NewsId")||e.GetQueryString("videoID"),l.videoID=e.GetQueryString("videoID")||l.articleID,l.getUID=d.cookie("expertnews.uid")||e.GetQueryString("uuid")||0,l.getAppId=appIDnewsinfo,l.firstLoad=!0,l.format(),l.getAllMenuList(),l.LeftMenuPowerTree(),l.scrollContent(),l.hotStrategyVideoList(),l.otherStategyVedioList(),l.navList(),l.scrollFixedArticle(),window.pulldownLoad=function(){var t,e=null,i=!0;d(function(){(e=d("#contentScroll").getNiceScroll(0)).jqbind("#contentScroll","scroll",function(){e.newscrolly>=e.page.maxh-50&&i&&(i=!i,clearTimeout(t),t=setTimeout(function(){l.flag?(a.tips("已加载全部","#contentScroll",{offset:["400px","50px"],tips:[2,"#cb4b4b"]}),l.flag=!1):l.flag,i=!i},500))}),e.scrollend(function(){var n,t=d("#contentScroll .atticle-show");d.each(t,function(t,e){var i=d(e),a=i.offset().top,s=i.height(),r=l.allarticleContentHeight-50;(a<=60&&s*(2/3)<a+s-50||60<a&&s*(2/3)<r-a)&&(n=i.attr("data-artid"),i.attr("data-view"))}),n!=undefined&&l.getNewsIDreadingCount(n)})})},window.pulldownLoad()},format:function(){g.registerHelper("renderTime",function(t){return t=t==undefined||null==t||0==t.length?"":"　"+t.slice(5,10),new g.SafeString(t)}),g.registerHelper("controlLines",function(t){return t==undefined||null==t||0==t.length?time="":10<=t.length&&t.length<=17?t=d.trim(t).substr(0,10)+"...":18<=t.length&&t.length<=22?t=t:22<t.length&&(t=d.trim(t).substr(0,22)+"..."),new g.SafeString(t)}),g.registerHelper("renderDate",function(t){return t=t==undefined||null==t||0==t.length?"":"　"+t.slice(5,10)+" "+t.slice(11,16),new g.SafeString(t)}),g.registerHelper("removeStyle",function(t){return t=t==undefined||null==t||0==t.length?"":d("<div>"+t+"</div>").text(),new g.SafeString(t)}),g.registerHelper("isSpreadThismenu",function(t){var e="";return e=0==t.length?"&#xe72e;":" ",new g.SafeString(e)})},firstMenuItemTrigger:function(){var t=this;e.GetQueryString("articleId")||e.GetQueryString("NewsID")||e.GetQueryString("videoID")||e.GetQueryString("ClientStrategyID")||e.GetQueryString("ClientStrategyGroupId")?e.GetQueryString("ClientStrategyGroupId")&&e.GetQueryString("ClientStrategyID")&&(t.ClientStrategyID=e.GetQueryString("ClientStrategyID"),d("#navList [data-classid="+e.GetQueryString("ClientStrategyGroupId")+"]").trigger("click")):(t.currentClassify=d("#navList .first-menu-title").eq(0).attr("data-classid"),t.firstOrSecondStrageId=t.currentClassify,t.firstOrSecondStrageName=d("#navList .first-menu-title").eq(0).attr("data-className"),t.classify=!0,d("#navList .first-menu-title").eq(0).children("i").hasClass("icon_right")&&d("#navList .first-menu-title").eq(0).trigger("click"),d("#navList .belong-to-first-menu").eq(0).find(".third-menu-item")||(t.clickArticleLoad=!1,t.ClientStrategyID=d("#navList .second-menu-title").eq(0).attr("data-clientstrategyid"),t.firstOrSecondStrageId=t.ClientStrategyID,t.firstOrSecondStrageName=d("#navList .second-menu-title").eq(0).attr("data-clientstrategyname"),d("#navList .second-menu-title").eq(0).trigger("click")))},scrollContent:function(){var t=this;t.srcollBar=function(){t.allarticleContentHeight=d(window).height()-50-230,d(".list").css("height",d(window).height()-40),d(".midddle-content-box").css("height",d(window).height()-50),d.each([".list",".midddle-content-box"],function(t,e){0<d(e).length&&d(e).niceScroll({cursorcolor:"#666",cursoropacitymax:.5,touchbehavior:!1,cursorwidth:"6px",cursorborder:"0",cursorborderradius:"8px",autohidemode:!1})})},t.srcollBar(),d(window).on("resize",function(){t.srcollBar()})},getFirstTypeStrategyList:function(t,n,l){var o=this,c=["{{#each Message}}",' <div class="third-menu-item" data-id="{{ID}}" data-index="0" data-page=""><div class="third-menu-link"><span class="cont">{{Title}}</span></div></div>',"{{/each}}"].join("");d.ajax({url:window.gConfig.apiHost+"strategyservice/getstrategygroupnewslist",type:"POST",timeout:5e3,dataType:"JSON",data:{StrategyGroupId:t,IsVideo:!0},success:function(t){if(d("#navList .third-menu-item").removeClass("current"),d("#navList .second-menu-title").removeClass("active"),0==(o.getData=t).RetCode&&t.Message&&0<t.Message.length){var a,e=g.compile(c)(t);o.stategyInfoIArr=[];var i=n.siblings(".belong-to-first-menu");i.html(e);var s=i.find(".third-menu-item").length;if(i.find(".third-menu-item").each(function(t,e){var i=d(this);o.stategyInfoIArr.push(i.attr("data-id"))}),0<s&&o.firstLoad&&1==o.isGroup)i.find(".third-menu-item").each(function(t,e){var i=d(this);1==o.isGroup&&i.attr("data-id")==o.articleID&&o.firstLoad&&(i.addClass("current"),a=l,o.articleListShow(o.stategyInfoIArr,a))}),o.firstLoad=!1;else if(0<s&&!o.firstLoad){var r;(r=i.find(".third-menu-item")).eq(0).addClass("current"),a=r.eq(0).attr("data-id"),o.articleListShow(o.stategyInfoIArr,a,"classify")}else 0!=s||o.firstLoad||d("#navList [data-clientstrategyid="+o.firstClassifyStrategyID+"]").trigger("click");if(null==o.isGroup&&o.firstLoad)o.firstLoad=!1,(r=n.siblings(".belong-to-first-menu").find(".third-menu-item")).eq(0).addClass("current"),a=r.eq(0).attr("data-id"),o.articleListShow(o.stategyInfoIArr,a);0==o.isGroup&&o.firstLoad&&(o.firstLoad=!1,d("#navList [data-clientstrategyid="+o.ClientStrategyID+"]").trigger("click")),d("#contentScroll").getNiceScroll(0).doScrollTop(2,.01)}else d("#navList .second-menu-title").removeClass("active"),0==o.isGroup&&o.firstLoad?(o.firstLoad=!1,d("#navList [data-clientstrategyid="+o.ClientStrategyID+"]").trigger("click")):1==o.isGroup&&o.firstLoad?(o.firstLoad=!1,d("#navList [data-clientstrategyid="+o.firstClassifyStrategyID+"]").trigger("click")):null==o.isGroup&&o.firstLoad?(o.firstLoad=!1,d("#navList [data-clientstrategyid="+o.firstClassifyStrategyID+"]").trigger("click")):o.firstLoad||d("#navList [data-clientstrategyid="+o.firstClassifyStrategyID+"]").trigger("click")},error:function(t,e,i){a.msg("该分类的二级菜单暂无数据显示，请稍后重试")}})},getFixedStrategyList:function(s,r,n){var l=this,i=["{{#each Message}}",' <li class="third-menu-item" data-id="{{ID}}" data-index="0" data-page=""><div class="third-menu-link" href="javascript:;"><span class="cont">{{Title}}</span></div></li>',"{{/each}}"].join("");d.ajax({url:window.gConfig.apiHost+"strategyservice/getstrategynewslist",type:"POST",timeout:5e3,dataType:"JSON",data:{ClientStrategyId:s,IsVideo:!0},success:function(t){if(0==(l.getFixedStrategyListData[s]=t).RetCode&&t.Message&&0<t.Message.length){var a,e=g.compile(i)(t);r.siblings("ul").html(e),l.stategyInfoIObj[s]=[],r.siblings("ul").find("li").each(function(t,e){var i=d(this);i.attr("data-id")==l.articleID?(i.addClass("current"),a=n,l.fixedArticle=!0):0==t&&(d(e).addClass("current"),a=d(e).attr("data-id")),l.stategyInfoIObj[s].push(i.attr("data-id"))}),l.articleListShow(l.stategyInfoIObj[s],a),d("#contentScroll").getNiceScroll(0).doScrollTop(2,.01)}else d("#articleList").html('<div class="noContent">'+r.attr("data-clientstrategyname")+"视频内容筹备中……</div>")},error:function(t,e,i){a.msg("该分类的二级菜单暂无数据显示，请稍后重试"),d("#articleList").html('<div class="noContent">'+r.attr("data-clientstrategyname")+"视频内容筹备中……</div>")}})},navList:function(){var s=this,t=d("#navList");t.on("click",".first-menu-title",function(){var t=d(this);d("#navList").find(".second-menu-title").removeClass("active");var e=t.attr("data-classid");s.firstOrSecondStrageName=d(this).attr("data-className"),s.firstOrSecondStrageId=e,null==s.ClientStrategyID&&(s.ClientStrategyID=t.siblings(".second-menu").find(".second-menu-title").eq(0).attr("data-clientstrategyid")),s.firstClassifyStrategyID=t.siblings(".second-menu").find(".second-menu-title").eq(0).attr("data-clientstrategyid"),s.ClientStrategyGroupId=e,s.currentClassify=e;var i=t.parents(".first-menu-item").siblings(".first-menu-item");if(t.children("i").hasClass("icon_right")?(i.find(".third-menu-item").removeClass("current"),t.children("i").attr("class","icon_down icon-1").html("&#xe72e;"),t.siblings().show(),t.siblings(".second-menu").find(".second-menu-title").removeClass("active").siblings(".third-menu").hide(),s.getFirstTypeStrategyList(e,t,s.articleID)):(t.children("i").attr("class","icon_right icon-1").html("&#xe604;"),t.siblings().hide()),s.loadALLStategy){var a=s.allStrategyListString.replace(s.currentClassify,"");s.otherLatestVideoList(a)}}),t.on("click",".second-menu-title",function(){d("#navList").find(".second-menu-title").removeClass("active"),d("#navList .third-menu-item").removeClass("current");var t=d(this);if(t.addClass("active"),t.children("i").hasClass("icon_plus")?(t.parents(".second-menu").siblings(".belong-to-first-menu").find(".third-menu-item ").removeClass("current"),t.children("i").attr("class","icon_ruduce icon-1 active").html("&#xe626;"),t.siblings(".third-menu").show(),d("#hotNewsList li").removeClass("current"),d("#strategyNewsList li").removeClass("current")):(t.children("i").attr("class","icon_plus icon-1").html("&#xe639;"),t.siblings(".third-menu").hide()),s.clickArticleLoad||(s.ClientStrategyID=d(this).attr("data-clientstrategyid"),s.firstOrSecondStrageId=s.ClientStrategyID,s.getFixedStrategyList(s.ClientStrategyID,d(this),s.articleID)),s.loadALLStategy){var e=s.allUserStategyListString.replace(s.ClientStrategyID,"");s.otherLatestVideoList(e)}}),d("#navList").on("click"," .belong-to-first-menu .third-menu-item",function(){d("#navList .third-menu-item").removeClass("current");var t=d(this);t.addClass("current").siblings(".third-menu-item").removeClass("current"),s.stategyInfoIArr=[],t.parents(".belong-to-first-menu").find(".third-menu-item").each(function(){var t=d(this);s.stategyInfoIArr.push(t.attr("data-id"))}),s.articleListShow(s.stategyInfoIArr,t.attr("data-id")),d("#hotNewsList li").removeClass("current"),d("#strategyNewsList li").removeClass("current"),d(".second-menu-title").removeClass("active"),s.clickArticleLoad=!1})},hotStrategyList:function(t){var i=this,a=["{{#each Message}}",'<li class="hotNewsItem" cid="{{ID}}">','<a href="javascript:;">','<i class="icon-1">&#xe608;</i>',"<span>{{Title}}</span>",'<div class="clearfloat"></div>',"</a>","</li>","{{/each}}"].join("");d.ajax({url:window.gConfig.apiHost+"strategyservice/gethotstrategyvideonews",type:"POST",timeout:5e3,dataType:"JSON",data:{ClientStrategyIdList:t},success:function(t){if(0==t.RetCode&&t.Message&&0<t.Message.length){i.hotVideoListData=t;var e=g.compile(a)(t);d("#hotNewsList").html(e)}else d("#hotNewsList").html('<div class="noContent">暂无热播视频...</div>')},error:function(t,e,i){d("#hotNewsList").html('<div class="noContent">暂无热播视频...</div>')}})},hotStrategyVideoList:function(){var a=this;d("#hotNewsList").on("click",".hotNewsItem",function(){var t=d(this),e=t.attr("cid"),i=[];t.addClass("current").siblings("li").removeClass("current"),d("#navList .third-menu-item").removeClass("current"),d("#navList .second-menu-title").removeClass("active"),d(".belong-to-first-menu").each(function(){var t=d(this);0<t.find(".third-menu-item").length&&t.find(".third-menu-item").removeClass("current")}),d("#strategyNewsList li").removeClass("current"),d(this).parents("#hotNewsList").find(".hotNewsItem").each(function(){var t=d(this);i.push(t.attr("cid"))}),a.articleListShow(i,e),a.clickArticleLoad=!1})},otherLatestVideoList:function(t){var a=this,s=["{{#each Message}}",'  <li class="strategy-news-item" data-articleId="{{ID}}"><span class="cont">{{Title}}</span><span class="time">{{renderTime LastModifyTime}}</span></li>',"{{/each}}"].join("");if(a.otherLatestVideo[a.ClientStrategyID]){var e=a.otherLatestVideo[a.ClientStrategyID],i=e;if(e.Message&&0<e.Message.length)i={Message:e.Message.slice(0,3)};if(0==e.RetCode&&e.Message&&0<e.Message.length){var r=g.compile(s)(i);d("#strategyNewsList").html(r)}}else d.ajax({url:window.gConfig.apiHost+"strategyservice/getnewststrategyvideonews",type:"POST",timeout:5e3,dataType:"JSON",data:{ClientStrategyIdList:t},success:function(t){var e=a.otherLatestVideo[a.ClientStrategyID]=t;if(t.Message&&0<t.Message.length)e={Message:t.Message.slice(0,3)};if(0==t.RetCode&&t.Message&&0<t.Message.length){var i=g.compile(s)(e);d("#strategyNewsList").html(i)}else d("#strategyNewsList").html('<div class="noContent">暂无其它最新视频...</div>')},error:function(t,e,i){d("#strategyNewsList").html('<div class="noContent">暂无其它最新视频...</div>')}})},otherStategyVedioList:function(){var s=this;d("#strategyNewsList").on("click",".strategy-news-item",function(){var t=d(this),e=t.attr("data-articleId");t.addClass("current").siblings("li").removeClass("current"),d(".belong-to-first-menu").each(function(){var t=d(this);0<t.find(".third-menu-item").length&&t.find(".third-menu-item").removeClass("current")}),d("#navList .third-menu-item").removeClass("current"),d("#navList .second-menu-title").removeClass("active"),d("#hotNewsList li").removeClass("current");for(var i=[],a=0;a<s.otherLatestVideo[s.ClientStrategyID].Message.length;a++)i.push(s.otherLatestVideo[s.ClientStrategyID].Message[a].ID);e!=undefined&&(s.articleListShow(i,e),s.clickArticleLoad=!1)})},articleListShow:function(t,i){var a=this;a.detailCode=["{{#each Message}}",'<div class=\'atticle-show section yaowen-article\' id="atticleShow{{ID}}" data-artid={{ID}} data-visited="false">',"        <div class='a-iner videoContent'>","            <div class='art-title'>",'                <h3 id="artcleTitle" title="">{{Title}}</h3>',"            </div>",'            <div class="art-subtitle">',"                <div class=' pull-right'>","                    <span class='view-tips'>",'                        <span class="vt-cell like" id="like{{ID}}" data-channelid={{ID}}>','                            <i class=\'icon-1\' id="likeicon{{ID}}">&#xe61b;</i><span class="liked" id="liked{{ID}}"></span></span>',"                </div>",'                <div class="pull-left ac-submain">',"                    <span>视频摘要</span>","                    <span>{{renderDate LastModifyTime}}</span>","                </div>",'                <div class="clearfloat"></div>',"            </div>",'            <div class="art-cnt">','                <div class="ac-iner">','                    <div class="ac-content  ywac-content" data-fontsizecnt>',"                        {{Summary}}","                    </div>",'                   <div class="videoPack" data-VideoUrl = "{{VideoUrl}}">',"                       {{#if CoverImg}}",'                       <div class="vedio cover-img" data-VideoUrl = "{{ VideoUrl }}"><img class="cover" src="{{CoverImg}}" /><img class="liveIcon" src="'+liveImg+'" /></div>{{else}}','                       <div class="vedio cover-img" data-VideoUrl = "{{ VideoUrl }}"><img calss="cover" src="'+imgplaceholder+'" /><img class="liveIcon" src="'+liveImg+'" /></div>{{/if}}','                       <div class="vedio iframe-box"><iframe src="" data-VideoUrl = "{{VideoUrl}}" frameborder="0"></iframe></div>',"                   </div> ","                </div>","            </div>","        </div>","    </div>","{{/each}}"].join(""),d.ajax({url:window.gConfig.apiHost+"strategyservice/getstrategynewsdetaillist",type:"POST",timeout:5e3,dataType:"JSON",data:{NewsInfoIdList:t.join(",")},success:function(t){if(0==t.RetCode&&t.Message&&0<t.Message.length){var e=g.compile(a.detailCode)(t);d("#articleList").html(e),i&&(a.currentArticleId=i,a.srcollArticle()),d("#articleList").on("click",".cover-img",function(){var t=d(this);(t=d(this)).parents("#articleList").find(".iframe-box").removeClass("open").find("iframe").attr("src",""),t.parents("#articleList").find(".cover-img").removeClass("close");var e=t.siblings(".iframe-box").addClass("open").find("iframe");e.attr("src",e.attr("data-VideoUrl")),t.addClass("close")}),a.getLikes(),a.clickLike()}else d("#articleList").html('<div class="noContent">暂无内容...</div>')},error:function(t,e,i){d("#articleList").html('<div class="noContent">暂无内容...</div>')}})},srcollArticle:function(){var t,e,i=this,a=d("#contentScroll").getNiceScroll(0),s=d("#contentScroll .ac-content img").length;0<s?d("#contentScroll .ac-content img").load(function(){--s||(t=d("#articleList").offset().top,e=d("[data-artid='"+i.currentArticleId+"']").offset().top,a.doScrollTop(Math.abs(e-t)))}).error(function(){--s||(t=d("#articleList").offset().top,e=d("[data-artid='"+i.currentArticleId+"']").offset().top,a.doScrollTop(Math.abs(e-t)))}):(t=d("#articleList").offset().top,e=d("[data-artid='"+i.currentArticleId+"']").offset().top,a.doScrollTop(Math.abs(e-t)))},scrollFixedArticle:function(){var e=this;e.scrollHeight=0,d("#navList").on("click",".third-menu .third-menu-item",function(){var t=d(this);d("#navList .third-menu-item").removeClass("current"),d("#navList .second-menu-title").removeClass("active"),t.parent().siblings(".second-menu-title").addClass("active"),e.currentArticleId=t.attr("data-id"),e.ClickCelueIndex=t.attr("data-index"),e.ClickCeluePage=t.attr("data-page"),e.newsInfoIArr=[],t.parent().find("li").each(function(){var t=d(this);e.newsInfoIArr.push(t.attr("data-id"))}),e.articleListShow(e.newsInfoIArr,t.attr("data-id")),t.addClass("current").siblings(".third-menu-item").removeClass("current"),e.clickArticleLoad=!1})},LeftMenuPowerTree:function(){var e;function i(t,e){try{return function i(){return window.external.EmObj}().EmFunc(t,e)}catch(a){}}return function(){try{e=i("EM_FUNC_GET_STRATEGY_GROUP")}catch(t){e=""}e!=undefined&&(e=(e=(e=e.replace(/,+/gm,",")).replace(/\[,+/gm,"[")).replace(/,+\]/gm,"]")),""!=e&&e!=undefined||(d("#navList .no-info").html("获取权限列表失败..."),d("#articleList .no-info").html("暂无数据，请稍后重试..."),d("#strategyNewsList .no-info").html("暂无数据，请稍后重试..."),d("#hotNewsList .no-info").html("暂无数据，请稍后重试..."))}(),e},getAllMenuList:function(){var a,s=this;d.ajax({type:"POST",url:window.gConfig.apiHost+"strategyservice/getclientstrategylist",data:{},dataType:"json",success:function(t){0==t.RetCode?a=t:d("#navList .no-info").html("获取策略总表失败")},error:function(){d("#navList .no-info").html("获取策略总表失败")}}).then(function(t){var e,i=0;for(e=s.LeftMenuPowerTree();(""==e||e==undefined)&&i<10;)e=s.LeftMenuPowerTree(),i++;""==e||undefined,""!=e&&e!=undefined&&""!=a&&a!=undefined&&s.usrPowerMenu(e,a)})},usrPowerMenu:function(t,e){var r=this,i=JSON.parse(t),a=JSON.parse(JSON.stringify(e.Message)),n={},l={},s=[];r.classifyId=[],d.each(i,function(t,e){e.hasOwnProperty("70005")||d.extend(l,e)}),d.each(l,function(t,e){n[t]={ParentId:"",ParentName:"",strategyList:[]}});a.length;d.each(a,function(t,e){var i=e.ParentId,a=e.ClientStrategyId+"",s=0;l[i]!=undefined&&(r.classifyId.push(e.ParentId),n[i].ParentId=e.ParentId,n[i].ParentName=e.ParentName,-1<(s=l[i].indexOf(a))&&n[i].strategyList.push({ClientStrategyId:e.ClientStrategyId,ClientStrategyName:e.ClientStrategyName,positionidx:s}))}),r.classifyIdNnique=function o(t){for(var e=[t[0]],i=1;i<t.length;i++)-1==e.indexOf(t[i])&&e.push(t[i]);return e}(r.classifyId),r.allClassifyIdString=r.classifyIdNnique.join(","),d.each(n,function(t,e){var i=e.strategyList;n[t].strategyList=i.sort(function(t,e){return t.positionidx-e.positionidx}),s.push(e)}),window.aaa=a,r.powOBJ=l,r.usrPowerMenuDom(s),r.allUserStategyList=[],d.each(r.powOBJ,function(t,e){r.allUserStategyList.push(e.join(",")),r.allUserStategyListString=d.trim(r.allUserStategyList.join(","))});var c=r.allUserStategyListString.replace(r.ClientStrategyID,"");if(r.allStrategyListString=r.allUserStategyListString+","+r.allClassifyIdString,r.classify)c=r.allStrategyListString.replace(r.currentClassify,"");else c=r.allStrategyListString.replace(r.ClientStrategyID,"");r.loadALLStategy=!0,r.hotStrategyList(r.allStrategyListString),r.otherLatestVideoList(c)},usrPowerMenuDom:function(t){var e=["{{#each this}}","{{#if ParentId}}",'<li class="first-menu-item">','    <div class="first-menu-title active" data-classid="{{ ParentId }}" data-className="{{ ParentName }}">','<i class="icon_right icon-1">&#xe604;</i>'," {{ ParentName }} </div>",' <div class="belong-to-first-menu">'," </div>",'    <ul class="second-menu">',"        {{#each strategyList }}",'        <li class="second-menu-item">','            <div class="second-menu-title" data-ClientStrategyId="{{ ClientStrategyId }}" data-ClientStrategyName="{{ ClientStrategyName }}" ><i class="icon_plus icon-1">&#xe639;</i>{{ ClientStrategyName }}</div>','            <ul class="third-menu">',"            </ul>","        </li>","         {{/each}}","    </ul>","</li>","{{else}}{{/if}}","{{/each}}"].join(""),i=g.compile(e)(t);d("#navList").html(i),this.firstMenuItemTrigger()},clickLike:function(){var t=this,e=d("#articleList");d(".like",e).on("click",function(){var s=d(this),r=s.parents(".atticle-show").attr("data-artid");s.hasClass("liked")||d.ajax({type:"post",dataType:"json",url:window.gConfig.likeDataServer,data:{uid:t.getUID,newsId:r,appId:t.getAppId},success:function(t,e){if("success"===e)if(t.isSucess){if(s.attr("data-channelid")==r){s.addClass("liked");var i=d("#liked"+r).html();d("#liked"+r).html(Number(i)+1),d("#likeicon"+r).html("&#xe66b;")}}else d("#likeicon").html("&#xe61b;"),d("#like"+r).removeClass("liked");else{s.addClass("liked");i=d("#liked"+r).html();d("#liked"+r).html(Number(i)+1),d("#likeicon"+r).html("&#xe66b;")}},error:function(t,e,i){s.addClass("liked");var a=d("#liked"+r).html();d("#liked"+r).html(Number(a)+1),d("#likeicon"+r).html("&#xe66b;")}})})},getLikes:function(){var e=this,i=[],s=d("#articleList");d(".like",s).each(function(){var t=d(this).parents(".atticle-show").attr("data-artid");i.push({uid:e.getUID,newsId:t,appId:e.getAppId})}),d.ajax({type:"post",contentType:"text/plain",dataType:"json",url:window.gConfig.likeListDataServer,data:JSON.stringify(i),success:function(a,t){a.isSucess?d(".like",s).each(function(){for(var t=d(this),e=t.parents(".atticle-show").attr("data-artid"),i=0;i<a.message.length;i++)a.message[i].newsId==e&&(t.find("span").text(a.message[i].likes),!0===a.message[i].liked?(d("#likeicon"+e).html("&#xe66b;"),d("#like"+e).addClass("liked")):!1===a.message[i].liked&&(d("#likeicon"+e).html("&#xe61b;"),d("#like"+e).removeClass("liked")))}):d(".like",s).each(function(){d(this).text(0)})},error:function(t,e,i){d(".like",s).each(function(){d(this).text(0)})}})},getNewsIDreadingCount:function(t){var i;t!=undefined&&""!=t&&null!=t&&0!=t&&((i=d("#atticleShow"+t)).attr("data-view")||d.ajax({type:"get",url:window.gConfig.apiHost+"click/addclick",contentType:"text/plain",data:{identity:t,clickType:"news.strategyNewsInfo"},dataType:"json",success:function(t,e){0==t.RetCode&&"SUCCESS"==t.RetMsg&&i.attr("data-view",!0)},error:function(t,e,i){}}))}}.init()});