define(["jquery","cors","utils","handlebars","nicescroll"],function(l,e,t,d,i){var u={nonedataHtml:'<div class="no-info">暂无数据显示，请稍后重试</div>',init:function(){t.appendSSO();var e=this;e.getUID=t.getUID(),e.getAppId=appIDcloudinfo,l.each(["#medialistScroll","#medialistScroll2","#iveNlPack","#iveNlPack2","#acScrollbox","#yaowenNlPack","#iveYwNlPack"],function(e,t){0<l(t).length&&l(t).niceScroll({cursorcolor:"#666",cursoropacitymax:.5,touchbehavior:!1,cursorwidth:"6px",cursorborder:"0",cursorborderradius:"8px",autohidemode:!1})}),e.yaowenList(),e.hotNews()},yaowenList:function(){var i,n,a,s,o=this,r=["{{#each Message}}","<div>",'            <h2 class="update-infos">',"                <span>{{renderDateTime PublishTime}}</span>","            </h2>",'        <div class="item section {{renderDateTimeed PublishTime}}">','            <div class="item-content">','                <div class="ic-iner">',"                    <div class='ic-title'>",'                        <span class="time">{{rendertime PublishTime}}</span>','                        <a href="'+pagerouter.yaowenArticle+'?NewsID={{NewsInformationId}}&source=5&from=reduTimeLine|title">{{ArticleTitle}}</a>',"                    </div>",'                    <a href="'+pagerouter.yaowenArticle+"?NewsID={{NewsInformationId}}&source=5&from=reduTimeLine|summary\" class='ic-txt'>{{ArticleSummary}}</a>","                    <div class='ic-footer'>","                        <span class='pull-right'>",'\t\t\t\t\t\t\t<b data-newsId="{{NewsInformationId}}"><i class="icon-1">&#xe61b;</i><span class="like"> </span></b>','                           <b><i class="icon-1">&#xe602;</i><span class="reading" data-ywnewsid="{{NewsInformationId}}"></span></b>',"                        </span>","                    </div>","                </div>","            </div>","        </div>","        </div>","        {{/each}}"].join("");d.registerHelper("renderDateTimeed",function(e){var t="";return e==undefined||null==e||0==e.length?t="":(i=e.slice(5,10),n!=i?(t="",n=i):t="closeDate"),t}),d.registerHelper("renderDateTime",function(e){var t,i="",n="";return e==undefined||null==e||0==e.length?i="":(a=e.slice(5,10),s!=a?(i=e.slice(5,7)+"月"+e.slice(8,10)+"日",s=a,n=""):(n="close",i=" ")),t='<span class="date '+n+'"> '+i+" </span>",new d.SafeString(t)}),d.registerHelper("targfilter",function(e){return e==undefined||null==e||0==e.length?"":e.replace(/【(.*?)】/gm,"")}),d.registerHelper("rendertime",function(e){return e==undefined||null==e||0==e.length?"":e.slice(11,16)});var c=l("#infos-list");l.ajax({url:window.gConfig.apiHost+"expertnews/getnewstop30",contentType:"application/json",type:"GET",timeout:ajaxTimeout,dataType:"JSON",success:function(e){if(0==e.RetCode&&e.Message&&0<e.Message.length){o.loadYaoWen=!0;for(var t=[],i=0;i<e.Message.length;i++)t.push(e.Message[i].NewsInformationId);var n=d.compile(r)(e);c.removeClass("no-info-cnt").html(n),o.clickLike(),o.showReading(t)}else o.loadYaoWen=!0,c.addClass("no-info-cnt").html(u.nonedataHtml)},error:function(e,t,i){c.addClass("no-info-cnt").html(u.nonedataHtml)}})},showReading:function(e){l.ajax({url:window.gConfig.apiHost+"click/queryclick",type:"GET",timeout:ajaxTimeout,dataType:"JSON",cache:!1,data:{identity:e.toString(),clickType:"news.information"},success:function(n){if(0==n.RetCode){l(".item .reading").each(function(e,t){var i=l(this);i.text(n.Message.Result[i.data("ywnewsid")])})}},error:function(e,t,i){}})},hotNews:function(){var i=this,n=l("#hotNewsList"),a=["{{#each Message}}","<li>",'<a href="'+pagerouter.yaowenArticle+'?NewsID={{NewsInformationId}}&source=3&from=reduAside|title">','<i class="icon-1">&#xe637;</i>',"<span>{{ArticleTitle}}</span>","</a>","</li>","{{/each}}"].join("");l.ajax({url:window.gConfig.apiHost+"expertnews/gethotnews",contentType:"application/json",type:"GET",timeout:ajaxTimeout,dataType:"JSON",success:function(e){if(0==e.RetCode&&e.Message&&0<e.Message.length){i.loadHotNews=!0;var t=d.compile(a)(e);n.removeClass("no-info-cnt").html(t)}else i.loadHotNews=!0,n.addClass("no-info-cnt").html(u.nonedataHtml)},error:function(e,t,i){n.addClass("no-info-cnt").html(u.nonedataHtml)}})},clickLike:function(){var t=this,i=[],a=l("#infos-list");l(".like",a).each(function(){var e=l(this).parents("b").attr("data-newsId");i.push({uid:t.getUID,newsId:e,appId:t.getAppId})}),l.ajaxSetup({contentType:"application/json; charset=utf-8"}),l.ajax({type:"get",timeout:ajaxTimeout,contentType:"text/plain",dataType:"jsonp",url:window.gConfig.likeListDataServerJsonp,data:{jsondata:JSON.stringify(i)},success:function(n,e){n.isSucess?l(".like",a).each(function(){for(var e=l(this),t=e.parents("b").attr("data-newsId"),i=0;i<n.message.length;i++)n.message[i].newsId==t&&e.text(n.message[i].likes)}):l(".like",a).each(function(){l(this).text(0)})},error:function(e,t,i){l(".like",a).each(function(){l(this).text(0)})}})}};u.init(),l.emoneyAanalytics().Init(tjAppid.expert,"yaowen_home","")});