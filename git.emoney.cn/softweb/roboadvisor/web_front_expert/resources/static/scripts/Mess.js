Array.prototype.forEach||(Array.prototype.forEach=function forEach(e,o){var n,i;if(null==this)throw new TypeError("this is null or not defined");var r=Object(this),t=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(1<arguments.length&&(n=o),i=0;i<t;){var a;i in r&&(a=r[i],e.call(n,a,i,r)),i++}});var add=function(){var e=0;return function(){return++e}}(),MBiz={_client:{AppId:"",GroupId:"",UserId:"",ConnectTime:"",Status:""},_FailTimes:0,_run:1,_longpool:null,stop:function(){MBiz._run=0},_sock:[],_sockupdate:function(n,i){MBiz._sock.forEach(function(e,o){e[0]==n&&MBiz._sock.splice(o,1,i)})},_sockdelete:function(n){MBiz._sock.forEach(function(e,o){e[0]==n&&MBiz._sock.splice(o,1)})},init:function(e,o,n,i,r,t,a,u){if(1==MBiz._run){var s;try{s=void 0!==u?new WebSocket(wsurl+"?appid="+e+"&groupid="+o+"&userid="+n+"&token="+u):new WebSocket(wsurl+"?appid="+e+"&groupid="+o+"&userid="+n)}catch(d){return}s.onopen=a,s.onmessage=i,s.onerror=t;var p=parseInt(1e5*Math.random());return MBiz._sock.push([p,s]),s.onclose=null==r?function(){setTimeout(function(){1==MBiz._run&&(MBiz.init(e,o,n,i,r,t,a),MBiz._sockdelete(p))},2e3)}:r,p}},initlongpoll:function(appid,groupid,userid,OnMessage,OnClose,OnError,OnOpen,querykey,GoBackProcess,Token){var pollingurl=longpollurl+"?appid="+appid+"&groupid="+groupid+"&userid="+userid+"&querykey="+escape(querykey)+"&_r="+Math.random();void 0!==Token&&(pollingurl=longpollurl+"?appid="+appid+"&groupid="+groupid+"&userid="+userid+"&querykey="+escape(querykey)+"&token="+Token+"&_r="+Math.random()),MBiz._longpool&&MBiz._longpool.abort(),MBiz._longpool=$.ajax({type:"GET",cache:!1,url:pollingurl,dataType:"jsonp",jsonp:"jsonpcallback",success:function(data,textStatus,jqXHR){if(null!=data&&""!=data&&"null"!=data)if("0"==data.RetCode){var ev={};eval("var obj="+data.Message+";"),"undefined"!=typeof obj&&(ev.data=obj,OnMessage(ev))}else"-100009"==data.RetCode?setTimeout(function(){MBiz.initlongpoll(appid,groupid,userid,OnMessage,OnClose,OnError,OnOpen,querykey,GoBackProcess)},100):"-200009"==data.RetCode?setTimeout(function(){MBiz.initlongpoll(appid,groupid,userid,OnMessage,OnClose,OnError,OnOpen,querykey,GoBackProcess)},6e4):GoBackProcess()},complete:function(e,o){},error:function(e,o,n){"timeout"==o&&MBiz.initlongpoll(appid,groupid,userid,OnMessage,OnClose,OnError,OnOpen,querykey,GoBackProcess)}})}};function newGuid(){for(var e="",o=1;o<=32;o++){e+=Math.floor(16*Math.random()).toString(16),8!=o&&12!=o&&16!=o&&20!=o||(e+="-")}return e}var browser={versions:function(){var e=navigator.userAgent;navigator.appVersion;return{trident:-1<e.indexOf("Trident"),presto:-1<e.indexOf("Presto"),webKit:-1<e.indexOf("AppleWebKit"),gecko:-1<e.indexOf("Gecko")&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/)||!!e.match(/AppleWebKit/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<e.indexOf("Android")||-1<e.indexOf("Linux"),iPhone:-1<e.indexOf("iPhone")||-1<e.indexOf("Mac"),iPad:-1<e.indexOf("iPad"),webApp:-1==e.indexOf("Safari")}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};