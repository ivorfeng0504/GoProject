$(function(){var s={title:"猜大盘涨跌",AwardName:"热股追踪",Summary:"专业基本面研究团队出品  精准定位行业热股机会"},t=$(".nav"),e=$("#currDate,#publishDate"),r=$("#guessbtn"),l="<tr><td colspan='4'>暂无数据显示</td></tr>";function n(){utils.request(utils.config.url+utils.config.getMyVoteData,"post",{},function(t){if(t.GuessChangeResultList){var s=t.GuessChangeResultList;s.length;$("#Count").html(t.JoinCount),$("#winCount").html(t.GuessedCount);for(var e=new Array,r=0;r<s.length&&r<5;r++){var n=s[r];e.push("<tr><td>"+n.IssueNumber.substr(4,2)+"-"+n.IssueNumber.substr(6,2)+"</td><td>"+n.ResultDesc+"</td><td>"+(-1!=n.CreateTime.indexOf("000")?"-":o(n.CreateTime).format("MM-dd hh:mm"))+"</td><td>"+n.StateDesc+"</td></tr>")}e.length||e.push(l),$("#guessList").html(e.join("")),e=null}else $("#prizeList").html(l);var i="<tr><td colspan='4'>暂无奖品，继续加油！</td></tr>";if(t.GuessChangeAwardList){var a=t.GuessChangeAwardList;if(a){for(e=new Array,r=0;r<a.length&&r<5;r++){var u=a[r];e.push("<tr><td>"+u.ActivityCycle+"</td><td>"+u.AwardName+"</td><td>"+o(u.PublishTime).format("MM-dd hh:mm")+"</td><td><a href='"+u.ReportUrl+"' target='_blank'>点击查看</a></td></tr>")}e.length||e.push(i),$("#prizeList").html(e.join("")),e=null}}else $("#prizeList").html(i)})}function i(t,s){var e=t+s,r=100/e;$("#riseBar").width(r*t),$("#downBar").width(r*s),$("#riseRate").html(Math.round(t/e*100)+"%"),$("#downRate").html(Math.round(s/e*100)+"%"),$("#result").addClass("active")}function o(t){return new Date(Date.parse(t.replace(/-/g,"/").replace(/T/," ")))}t.on("click",".nav-item",function(t){$(this).addClass("on").siblings().removeClass("on")}),$(document).on("click",".radio-box",function(t){t.preventDefault(),r.hasClass("disabled")||($(this).parents(".guesswrapper").addClass("on"),$(this).addClass("on").siblings().removeClass("on"))}).on("click",".closer",function(t){t.preventDefault(),utils.closeWin($(this).parents(".popwin").attr("id"))}).on("click",".guessbtn",function(t){t.preventDefault();var s,e=$(".guesswrapper .radio-box.on").attr("data-type");e&&(s=e,utils.request(utils.config.url+utils.config.sendData,"post",{result:s},function(t){t.IsJoin&&r.addClass("disabled"),i(t.GuessUp,t.GuessDown),n()}))}).on("click","#more",function(t){t.preventDefault(),utils.request(utils.config.url+utils.config.getHisData,"post",{},function(t){if(t){for(var s=new Array,e=0;e<t.length&&e<10;e++){var r=t[e];s.push("<tr><td>"+r.IssueNumber.substr(4,2)+"-"+r.IssueNumber.substr(6,2)+"</td><td>"+r.ResultDesc+"</td><td>"+o(r.CreateTime).format("MM-dd hh:mm")+"</td><td>"+r.StateDesc+"</td></tr>")}s.length||s.push(l),$("#hisTabCnt").html(s.join("")),s=null}else $("#hisTabCnt").html(l);utils.openWin("popHis")})}),utils.request(utils.config.url+utils.config.getData,"post",{},function(t){if(!t)return!1;e.html(t.IssueNumber.substr(4,2)+"月"+t.IssueNumber.substr(6,2)+"日"),t.isGuess,t.IsJoin&&(i(t.GuessUp,t.GuessDown),r.addClass("disabled"),$("#result").addClass("active"))}),n(),utils.request(utils.config.url+utils.config.getPrizeInfo,"post",{},function(t){t.length&&(s=t[0]),$("#reportName").html("赢《"+s.AwardName+"》"),$("#brief").html(s.Summary),$("#prizeName").html(s.AwardName)})});